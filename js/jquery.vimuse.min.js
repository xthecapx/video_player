/*! Vimuse - HTML5 Media Player - 3.2.1
 * Copyright 2015, Nilok Bose
 * http://codecanyon.net/user/cosmocoder
*/
Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),i=this,s=function(){},a=function(){return i.apply(this instanceof s&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return s.prototype=this.prototype,a.prototype=new s,a}),function(e,t,i){"use strict";var s={init:function(s,a){this.options=s,this.isChrome=null!==navigator.userAgent.match(/chrome/gi),this.isSafari=null!==navigator.userAgent.match(/webkit/gi)&&!this.isChrome,this.isOpera=null!==navigator.userAgent.match(/opera/gi),this.isiOS=null!==navigator.userAgent.match(/(iPad|iPhone|iPod)/gi),this.isAndroid=null!==navigator.userAgent.match(/android/i),this.hasTouch="ontouchstart"in i,this.msie=-1!=navigator.appName.toLowerCase().indexOf("microsoft"),this.isIE9=this.msie&&9==parseFloat(navigator.appVersion.split("MSIE")[1],10),this.isIE8=this.msie&&parseFloat(navigator.appVersion.split("MSIE")[1],10)<=8,this.ie9js=this.msie&&i.IE7&&IE7.recalc?!0:!1,this.$app=e(a).addClass("vm-container playlist-"+this.options.playlistPosition+" cf"),this.$stage=e('<div class="vm-stage loading"/>').appendTo(this.$app),this.$currentInfo=e('<div class="current-item-info"/>').appendTo(this.$stage),this.$audioDetails=e('<div class="vm-audio-details"/>').appendTo(this.$stage),this.$audioPoster=this.$audioDetails.append('<div class="vm-audio-poster"><img src="" /></div>').children("div.vm-audio-poster"),this.$audioInfo=this.$audioDetails.append('<div class="vm-audio-info"><p class="track"></p><p class="artist"></p><p class="album"></p></div>').children("div.vm-audio-info"),this.$player=e('<div class="vm-player"/>').appendTo(this.$stage),this.$playlist=e('<ol class="vm-playlist"/>').appendTo(this.$app).addClass(this.options.playlistPosition),this.curItem=0,this.loopEnabled=!1,this.shuffleEnabled=!1,this.player=null;var l=e("body").find(".vm-container").index(this.$app);this.$app.data("vmid",l),this.$postrollContainer=e('<div id="vm-postroll-'+l+'" class="vm-postroll"/>').appendTo("body"),this.customMEPostroll(),this.$overlay=e("div.vm-player-overlay"),0===this.$overlay.length&&(this.$overlay=e('<div class="vm-player-overlay" />').appendTo("body")),this.$playlist.addClass(this.hasTouch?"touch":"no-touch"),!this.hasTouch&&this.$playlist.addClass("custom-scrollbar"),this.hasTouch?this.clickEventType="tap":this.clickEventType="click","audio"===this.options.mediaType&&(this.$app.addClass("only-audio"),this.options.showFileTypeIcons=!1,this.options.showAudioDetails||this.$app.addClass("no-audio-details"),this.options.showAudioCover||this.$app.addClass("no-cover"),this.options.showAudioTrackInfo||this.$app.addClass("no-track-info"));var o='<div class="vm-aux-controls"><a class="vm-prev-track" title="Play Previous Item"></a><a class="vm-next-track active" title="Play Next Item"></a><a class="vm-repeat" title="Repeat Current Item"></a><a class="vm-shuffle" title="Shuffle Playlist"></a><a class="vm-show-playlist active" title="Show/hide playlist"></a><a class="vm-make-fullscreen" title="Make the player fullscreen"></a><a class="vm-lights active" title="Turn lights on/off"></a><a class="vm-search" title="Search to filter items"></a></div><div class="vm-search-box"><input type="text" placeholder="Type to filter items &hellip;" /></div>';if(this.$player.after(o),this.$prevTrack=this.$app.find("a.vm-prev-track"),this.$nextTrack=this.$app.find("a.vm-next-track"),this.$repeat=this.$app.find("a.vm-repeat"),this.$shuffle=this.$app.find("a.vm-shuffle"),this.$showPlaylist=this.$app.find("a.vm-show-playlist"),this.$makeFullscreen=this.$app.find("a.vm-make-fullscreen"),this.$lights=this.$app.find("a.vm-lights"),this.$search=this.$app.find("a.vm-search"),this.$searchBox=this.$app.find("div.vm-search-box"),(t.documentElement.requestFullscreen||t.documentElement.mozRequestFullScreen||t.documentElement.webkitRequestFullscreen||t.documentElement.msRequestFullscreen)&&this.$makeFullscreen.css("display","inline-block"),this.options.showPlaylistOnLoad||(this.$showPlaylist.removeClass("active"),this.$playlist.hide(),"bottom"!==this.options.playlistPosition&&this.$stage.css({width:"100%",margin:"auto","float":"none",height:"auto"})),this.options.showAuxControls||this.$app.find("div.vm-aux-controls").hide(),this.options.shuffle&&this.shufflePlaylist(),this.options.detectMobile)var n=this.detectMobile();else{var n=e.Deferred();n.resolve("false"),this.isMobile=!1}var r=this;n.done(function(t){if("true"===t&&(r.isMobile=!0),r.options.enableCache)var i=r.getCache();else{var i=e.Deferred();i.resolve({expired:!0})}i.done(function(e){if(e.expired){var t=r.getPlaylist();t.done(!r.options.youtubeFeed&&!r.options.vimeoFeed&&!r.options.dailymotionFeed&&r.options.getID3Info||r.options.scanMP3Folder?r.setMediaInfo.bind(r):r.playlistLoaded.bind(r))}else r.playlist=e,r.processPlaylist()})}),e.expr[":"].contains=function(e,t,i){return jQuery(e).text().toUpperCase().indexOf(i[3].toUpperCase())>=0}},customMEPostroll:function(){e.extend(MediaElementPlayer.prototype,{buildvmpostroll:function(t,i,s,a){var l=this,o=l.container.find('link[rel="postroll"]').attr("href");"undefined"!=typeof o&&(t.postroll=e('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="jQuery(this).parent().hide();return false;">&times;</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(s).hide(),l.media.addEventListener("ended",function(i){s.find(".mejs-postroll-layer-content").html(e(o).html()),t.postroll.show()},!1))}})},detectMobile:function(){return e.ajax({url:this.options.phpFolder+"/mobile.php",dataType:"text"})},getPlaylist:function(){var i=this;if(i.options.youtubeFeed){var s="https://www.googleapis.com/youtube/v3/",a=i.options.youtubeOptions;"user"===a.source?s+="channels/?part=contentDetails&forUsername="+a.userID:"playlist"===a.source?s+="playlistItems/?playlistId="+a.playlistID+"&part=contentDetails":"search"===a.source&&(s+="search?q="+a.search+"&part=snippet"),s+="&maxResults="+a.limit+"&key="+i.options.youtubeAPIKey+"&callback=?"}else if(i.options.vimeoFeed){var s="https://vimeo.com/api/v2/",l=i.options.vimeoOptions;"user"===l.source?s+=l.userID+"/videos.json":"album"===l.source?s+="album/"+l.albumID+"/videos.json":"channel"===l.source&&(s+="channel/"+l.channelID+"/videos.json"),s+="?callback=?"}else if(i.options.dailymotionFeed){var s="https://api.dailymotion.com/",o=i.options.dailymotionOptions;"user"===o.source?s+="user/"+o.userID:"playlist"===o.source?s+="playlist/"+o.playlistID:"group"===o.source?s+="group/"+o.groupID:"channel"===o.source&&(s+="channel/"+o.channelID),s+="/videos?fields=duration,title,thumbnail_120_url,tiny_url&limit="+o.limit+"&callback=?"}else if(i.options.scanMP3Folder){var n=i.options.mp3Folder,s=i.options.phpFolder+"/get-mp3.php";if(-1===n.indexOf("http")){var r=t.createElement("a");r.href=n,n=r.href}}else var s=i.options.playlistURL;if(i.options.scanMP3Folder)return e.getJSON(s,{folder:n});if(i.options.youtubeFeed&&"user"===i.options.youtubeOptions.source){var p=e.Deferred();return e.getJSON(s,function(t){var s=t.items[0].contentDetails.relatedPlaylists.uploads;e.getJSON("https://www.googleapis.com/youtube/v3/playlistItems?key="+i.options.youtubeAPIKey+"&part=contentDetails&playlistId="+s+"&maxResults="+a.limit+"&callback=?",function(e){p.resolve(e)})}),p}return e.getJSON(s)},getCache:function(){var t=e.ajax({type:"post",data:{interval:this.options.cacheInterval,cacheFile:this.options.cacheFileName},url:this.options.cacheFolder+"/get-cache.php",dataType:"json",global:!1});return t},updateCache:function(t){e.ajax({type:"post",data:{playlist:JSON.stringify(t),cacheFile:this.options.cacheFileName},url:this.options.cacheFolder+"/update-cache.php",dataType:"json",global:!1})},setMediaInfo:function(i){var s,a=this,l=[],o=t.createElement("a");a.options.scanMP3Folder||e.each(i,function(e){"audio"===i[e].type&&-1===i[e].mp3.indexOf("http")&&(o.href=i[e].mp3,i[e].mp3=o.href),"video"===i[e].type&&-1===i[e].mp4.indexOf("http")&&(o.href=i[e].mp4,i[e].mp4=o.href)}),e.ajax({url:a.options.phpFolder+"/media-info.php",data:{json:JSON.stringify(i)},dataType:"json",type:"post",success:function(t){s=t,l=e.map(s,function(t,i){if("audio"===s[i].type&&s[i].searchTerm){var a=e.ajax({url:"https://itunes.apple.com/search",data:{term:s[i].searchTerm,media:"music",entity:"album",limit:1},dataType:"jsonp",success:function(e){if("undefined"!=typeof e.results[0]){var t=e.results[0].artworkUrl100;t=t.replace("100x100","600x600"),s[i].poster=t}}});return a}}),e.when.apply(e,l).done(function(){a.playlistLoaded(s)})}})},playlistLoaded:function(t){var i=this,s=[];if(i.options.youtubeFeed){i.playlist=[];var a=[],l=e.Deferred();"search"===i.options.youtubeOptions.source?e.each(t.items,function(e){a.push(this.id.videoId)}):e.each(t.items,function(e){a.push(this.contentDetails.videoId)}),e.getJSON("https://www.googleapis.com/youtube/v3/videos/?key="+i.options.youtubeAPIKey+"&id="+a.join(",")+"&part=snippet,contentDetails&callback=?",function(t){e.each(t.items,function(e){i.playlist[e]={},i.playlist[e].title=this.snippet.title,i.playlist[e].description=this.snippet.description,i.playlist[e].type="youtube",i.playlist[e].link="https://www.youtube.com/watch?v="+this.id,i.playlist[e].duration=i.formatDuration(i.parseYoutubeDuration(this.contentDetails.duration)),i.playlist[e].poster=this.snippet.thumbnails["default"].url}),l.resolve()}),s.push(l)}else if(i.options.vimeoFeed){i.playlist=[];var l=e.Deferred();e.each(t,function(e){return i.playlist[e]={},i.playlist[e].title=this.title,i.playlist[e].description=this.description.replace(/(<([^>]+)>)/gi,""),i.playlist[e].type="vimeo",i.playlist[e].link=this.url,i.playlist[e].duration=i.formatDuration(this.duration),i.playlist[e].poster=this.thumbnail_medium,e===i.options.vimeoOptions.limit-1?!1:void 0}),l.resolve(),s.push(l)}else if(i.options.dailymotionFeed){i.playlist=[];var l=e.Deferred();e.each(t.list,function(e){i.playlist[e]={},i.playlist[e].title=this.title,i.playlist[e].type="dailymotion",i.playlist[e].link=this.tiny_url,i.playlist[e].duration=i.formatDuration(this.duration),i.playlist[e].poster=this.thumbnail_120_url}),l.resolve(),s.push(l)}else i.playlist=t,s=[],e.each(t,function(a){if("youtube"===t[a].type)var l=t[a].link.split("v=")[1],o="https://www.googleapis.com/youtube/v3/videos/?key="+i.options.youtubeAPIKey+"&id="+l+"&part=snippet,contentDetails&callback=?",n=e.getJSON(o,function(e){i.playlist[a].duration=i.formatDuration(i.parseYoutubeDuration(e.items[0].contentDetails.duration)),i.playlist[a].poster=e.items[0].snippet.thumbnails["default"].url,t[a].title||(i.playlist[a].title=e.items[0].snippet.title)});else if("vimeo"===t[a].type)var l=t[a].link.split("/").pop(),o="https://vimeo.com/api/v2/video/"+l+".json?callback=?",n=e.getJSON(o,function(e){i.playlist[a].duration=i.formatDuration(e[0].duration),i.playlist[a].poster=e[0].thumbnail_medium,t[a].title||(i.playlist[a].title=e[0].title)});else if("dailymotion"===t[a].type)var l=t[a].link.split("/").pop(),o="https://api.dailymotion.com/video/"+l+"?fields=duration,thumbnail_120_url,title&callback=?",n=e.getJSON(o,function(e){i.playlist[a].duration=i.formatDuration(e.duration),i.playlist[a].poster=e.thumbnail_120_url,t[a].title||(i.playlist[a].title=e.title)});else if("video"===t[a].type){var r=i.isMobile?t[a].mobileMp4:t[a].mp4,n=e.Deferred();if(i.options.getID3Info)n.resolve();else if(i.isiOS||i.isAndroid||i.isIE8)i.playlist[a].duration="0:00",n.resolve();else{var p=e('<video id="vm-test-video-'+a+'" class="vm-test-video" preload="metadata" src="'+r+'">').appendTo("body");new MediaElement("vm-test-video-"+a,{success:function(t){t.addEventListener("loadedmetadata",function(){i.playlist[a].duration=i.formatDuration(t.duration),n.resolve(),p.remove(),"native"!==t.pluginType&&e("#"+t.pluginElement.id).remove(),e("#"+t.id+"_container").remove()})}})}}else if("audio"===t[a].type){var r=t[a].mp3,n=e.Deferred(),d="";if(d=t[a].artist?t[a].track+" - "+t[a].artist:t[a].track?t[a].track:t[a].mp3.split("/").pop().split(".")[0],i.playlist[a].title=d,i.options.getID3Info)n.resolve();else if(i.isiOS||i.isAndroid||i.isIE8)i.playlist[a].duration="0:00",n.resolve();else{var c=e('<audio id="vm-test-audio-'+a+'" class="vm-test-audio" preload="metadata" src="'+r+'">').appendTo("body");new MediaElement("vm-test-audio-"+a,{success:function(t){t.addEventListener("loadedmetadata",function(){i.playlist[a].duration=i.formatDuration(t.duration),n.resolve(),c.remove(),"native"!==t.pluginType&&e("#"+t.pluginElement.id).remove(),e("#"+t.id+"_container").remove()})}})}}else if("radio"===t[a].type){if(i.options.pullRadioStreamCover){var n=i.getStreamInfo(t[a]);n.done(function(e){"new"===e.status&&(i.playlist[a].poster=e.cover)})}else{var n=e.Deferred();n.resolve()}i.playlist[a].duration="0:00",i.playlist[a].track=""}s.push(n)});e.when.apply(e,s).done(function(){i.options.enableCache&&i.updateCache(i.playlist),i.processPlaylist()})},processPlaylist:function(){var t=this;t.setupPlaylist(),t.options.fixPlayerOnScroll&&"bottom"===t.options.playlistPosition&&!t.hasTouch&&t.setupStageLock(),t.bindEvents(),t.$playlist.children("li").eq(0).find("span.title").trigger(t.clickEventType),t.options.enablePlaylistSort&&(t.$playlist.sortable({axis:"y",cancel:"a",containment:"parent",cursor:"move",items:"> li",revert:400,helper:"clone",placeholder:"item-holder",stop:function(){t.hasTouch&&t.$playlist.sortable("disable").children("li").removeClass("selected")}}),t.hasTouch&&(t.$playlist.sortable("disable"),t.$app.hammer({swipeVelocityY:.3,dragMinDistance:60}).on("swipeup swipedown",".vm-playlist",function(e){t.$playlist.sortable("disable")}).on("tap",".vm-playlist li",function(i){t.$playlist.sortable("enable"),e(this).addClass("selected")}))),"bottom"===t.options.playlistPosition&&"auto"!==t.bottomPlaylistMaxHeight&&t.$playlist.css("max-height",t.options.bottomPlaylistMaxHeight),t.$playlist.filter(".custom-scrollbar").perfectScrollbar({minScrollbarLength:20,suppressScrollX:!0}),e(i).trigger("resize"),t.$stage.removeClass("loading"),t.onSetup()},formatDuration:function(e){e=parseInt(e,10);var t=parseInt(e/3600)%24,i=parseInt(e/60,10)%60,s=e%60,a="";return a=t>0?t+":"+(10>i?"0"+i:i)+":"+(10>s?"0"+s:s):i+":"+(10>s?"0"+s:s)},parseYoutubeDuration:function(e){var t=e.match(/[0-9]+[HMS]/g),i=0;return t.forEach(function(e){var t=e.charAt(e.length-1),s=parseInt(e.slice(0,-1));switch(t){case"H":i+=60*s*60;break;case"M":i+=60*s;break;case"S":i+=s}}),i},setupPlaylist:function(){for(var e=this,t="",i=e.playlist.length,s=e.options.showFileTypeIcons?"":"no-icons",a=e.options.showPlaylistThumbs?" show-thumb":"",l=0;i>l;l++){if(t+='<li class="'+s+a+'" data-type="'+e.playlist[l].type+'" data-id="'+l+'">',t+=e.options.showPlaylistThumbs?'<span class="item-thumb"><img src="'+e.playlist[l].poster+'"></span>':"",t+='<span class="title">'+e.playlist[l].title+"</span>",t+=e.options.showItemDuration?'<span class="duration">'+e.playlist[l].duration+"</span>":"",t+=e.options.showDeleteButtons?'<a class="delete"></a>':"",e.options.showLyricsLinks&&e.playlist[l].lyrics&&(t+='<a class="lyrics" href="'+e.playlist[l].lyrics+'" download="'+e.playlist[l].lyrics.split("/").pop()+'" title="Download the lyrics of this song"></a>'),e.options.showDownloadLinks&&e.playlist[l].free!==!1){var o=e.playlist[l].downloadName;"video"===e.playlist[l].type?((void 0===o||""==o)&&(o=e.playlist[l].mp4.split("/").pop()),t+='<a class="free-media '+e.playlist[l].type+'" href="'+e.playlist[l].mp4+'" download="'+o+'" title="Download mp4 version of this video"></a>'):"audio"===e.playlist[l].type&&((void 0===o||""==o)&&(o=e.playlist[l].mp3.split("/").pop()),t+='<a class="free-media '+e.playlist[l].type+'" href="'+e.playlist[l].mp3+'" download="'+o+'" title="Download mp3 version of this audio"></a>')}e.options.showPurchaseLinks&&e.playlist[l].purchase&&(t+='<a class="purchase" href="'+e.playlist[l].purchase+'" title="Visit page to purchase item"',t+=e.options.newWindowPurchaseLinks?' target="_blank">':">",t+="</a>"),e.options.showURLLinks&&e.playlist[l].url&&(t+='<a class="link" href="'+e.playlist[l].url+'" title="Visit page"',t+=e.options.newWindowURLLinks?' target="_blank">':">",t+="</a>"),t+="</li>"}e.$playlist.html(t)},createPlayer:function(t,s){var a,l=this,o=l.$playlist.children("li"),n=o.index(o.filter("li.current")),r=l.$app.data("vmid");if(0!==n&&(l.options.autoplayOnPlayerLoad=!0),"video"===t.type){var p=l.isMobile?t.mobileMp4:t.mp4;a='<video preload="metadata" width="640" height="360" poster="'+t.poster+'" style="width: 100%;">',a+='<source type="video/mp4" src="'+p+'" />',t.webm&&(a+='<source type="video/webm" src="'+t.webm+'" />'),t.ogv&&(a+='<source type="video/ogg" src="'+t.ogv+'" />'),t.subtitle&&e.each(t.subtitle,function(){a+='<track kind="subtitles" src="'+this.file+'" srclang="'+this.lang+'" />'}),t.postroll&&(a+='<link rel="postroll" href="#vm-postroll-'+r+'" />',l.$postrollContainer.html(t.postroll)),a+="</video>"}else if("youtube"===t.type)a=l.isiOS||l.isAndroid?'<video controls preload="none" width="640" height="360" style="width: 100%;">':'<video controls preload="none" width="640" height="360" style="max-width: 100%;">',a+='<source type="video/youtube" src="'+t.link+'" />',a+="</video>";else if("vimeo"===t.type){var d=t.link.split("/").pop(),c=l.options.autoplay?"&autoplay=1":"";c=l.options.autoplayOnPlayerLoad||0!==n?c:"",a='<iframe src="https://player.vimeo.com/video/'+d+"?api=1&player_id="+d+c+'" width="640" height="360" frameborder="0" webkitAllowFullScreen allowFullScreen></iframe>'}else if("dailymotion"===t.type){var d=t.link.split("/").pop(),c=l.options.autoplay?"&autoplay=1":"";c=l.options.autoplayOnPlayerLoad||0!==n?c:"",a='<iframe src="https://www.dailymotion.com/embed/video/'+d+"?api=postMessage"+c+'" width="640" height="360" frameborder="0" allowfullscreen></iframe>'}else if("radio"===t.type){var u=t.link+"?nocache="+Math.floor(1e4*Math.random());a='<audio controls type="audio/mpeg" width="640" style="width: 100%" src="'+u+'"></audio>'}else a='<audio controls width="640" style="width: 100%">',a+='<source type="audio/mpeg" src="'+t.mp3+'" />',t.ogg&&(a+='<source type="audio/ogg" src="'+t.ogg+'" />'),a+="</audio>";if(l.$stage.height(l.$stage.height()),l.$player.removeClass().addClass("vm-player"),"audio"===t.type||"radio"===t.type){var h=l.$audioPoster.children("img")[0];h.src=t.poster,h.onload=function(){l.$audioPoster.removeClass("img-loading")},l.$audioPoster.show().addClass("img-loading"),l.$player.addClass(t.type),"audio"===l.options.mediaType&&(l.$audioInfo.children("p.track").html(t.track),l.$audioInfo.children("p.artist").html(t.artist),l.$audioInfo.children("p.album").html(t.album))}else l.$audioPoster.hide();("video"===t.type||"youtube"===t.type)&&l.$player.addClass("video"),"vimeo"===t.type&&l.$player.addClass("vimeo"),"dailymotion"===t.type&&l.$player.addClass("dailymotion"),"audio"!==l.options.mediaType&&(l.$currentInfo.html(t.title).css("display","block"),setTimeout(function(){l.$currentInfo.css("display","")},2e3)),l.player&&("native"!==l.player.media.pluginType&&l.player.media.pluginElement&&e("#"+l.player.media.pluginElement.id).parent().remove(),l.$player.empty(),clearInterval(l.radioStreamInterval),delete mejs.players[l.player.id],l.player.globalUnbind(),l.player=null),e(i).off("message.vimuse"),l.$player.hasClass("video")&&l.isChrome&&l.$stage.css("overflow","hidden"),l.$player.html(a).not(".vimeo, .dailymotion").children().mediaelementplayer({hideVolumeOnTouchDevices:l.isAndroid?!0:!1,alwaysShowControls:l.isiOS,startVolume:l.options.volume,enablePluginSmoothing:!0,iPadUseNativeControls:"youtube"===t.type,startLanguage:l.options.startLanguage,mode:l.isChrome&&!l.isiOS&&!l.isAndroid||"radio"===t.type&&l.isOpera?"shim":"auto",features:"radio"===t.type?["playpause","current","volume"]:["playpause","current","progress","duration","tracks","volume","fullscreen","vmpostroll"],success:function(e,i,a){if(l.player=a,l.$stage.css("height","auto"),l.isiOS&&"youtube"===t.type){var o=l.$player.find("iframe").attr("src");o=o.replace("controls=0","controls=1"),l.$player.find("iframe").attr("src",o)}if(l.$player.hasClass("video")){var r=l.$player.width(),p=.5625*r;!l.isiOS&&!l.isAndroid&&l.player.media.setVideoSize(r,p),a.setPlayerSize(r,p),a.setControlsSize(),l.isChrome&&l.$stage.css("overflow","")}l.ie9js&&IE7.recalc(),s=l.options.autoplayOnPlayerLoad||0!==n?s:!1,s&&("youtube"===t.type?e.addEventListener("canplay",function(){a.play()},!1):e.play()),"radio"===t.type&&l.options.pullRadioTrackInfo&&(l.changeRadioInfo(t),l.radioStreamInterval=setInterval(function(){l.changeRadioInfo(t)},l.options.radioInfoPollInterval)),e.addEventListener("play",l.started.bind(l),!1),e.addEventListener("pause",l.paused.bind(l),!1),e.addEventListener("timeupdate",l.timeupdate.bind(l),!1),e.addEventListener("ended",l.finishedPlaying.bind(l),!1)}}),l.$player.hasClass("vimeo")?(l.$stage.css("height","auto"),e(i).on("message.vimuse",l.vimeoMsgReceived.bind(l))):l.$player.hasClass("dailymotion")&&(l.$stage.css("height","auto"),e(i).on("message.vimuse",l.dailymotionMsgReceived.bind(l)))},changeRadioInfo:function(e){var t=this,i=t.getStreamInfo(e);i.done(function(i){if("new"===i.status){var s=t.playlist[t.curItem].title+" - "+i.track,a=i.cover;t.playlist[t.curItem].track=i.track,"audio"===t.options.mediaType&&t.$audioInfo.children("p.track").html(i.track),t.$playlist.find("li.current span.title").text(s),t.$currentInfo.html(s),t.options.pullRadioStreamCover?(t.playlist[t.curItem].poster=a,t.$playlist.find("li.current img")[0].src=a,t.$audioPoster.children("img")[0].src=a):t.$audioPoster.children("img")[0].src=e.poster}else"same"===i.status?t.$currentInfo.html(t.playlist[t.curItem].title+" - "+t.playlist[t.curItem].track):"locked"===i.status&&clearInterval(t.radioStreamInterval)})},getStreamInfo:function(t){var i=e("<a>",{href:t.link})[0];return e.ajax({url:this.options.phpFolder+"/stream-info.php",cache:!1,data:{protocol:i.protocol,rootUrl:i.host,path:i.pathname,type:t.radioType,track:t.track,pullCover:this.options.pullRadioStreamCover},dataType:"json",global:!1})},vimeoMsgReceived:function(e){var t=JSON.parse(e.originalEvent.data),i=this.$player.find("iframe"),s=i.attr("src").split("?")[0];if("ready"===t.event){var a={method:"addEventListener",value:"finish"};i[0].contentWindow.postMessage(JSON.stringify(a),s)}else"finish"===t.event&&this.finishedPlaying()},dailymotionMsgReceived:function(e){var t=e.originalEvent.data.split("=").pop();"ended"===t&&this.finishedPlaying()},finishedPlaying:function(){var e=this,t=e.$playlist.children("li"),i=t.index(t.filter("li.current"));if(e.ended(),e.options.playlistProgress)if(e.shuffleEnabled){var s=t.not(".played"),a=Math.floor(Math.random()*s.length);if(0===s.length)return!1;!a&&(a=0),i=a,s.eq(i).find("span.title").trigger(e.clickEventType)}else if(e.loopEnabled)e.player.play();else{if(i===t.length-1)return!1;t.eq(++i).find("span.title").trigger(e.clickEventType)}},resizeItemTitle:function(){var t=this;"bottom"!==t.options.playlistPosition&&!t.$playlist.hasClass("no-float")&&t.options.showPlaylistThumbs?t.$playlist.find("span.title").css("width",""):(t.$playlist.is(":hidden")&&t.$playlist.addClass("resizing"),t.$playlist.children("li").each(function(){var t=e(this),i=t.width(),s=t.children("a.free-media").outerWidth(!0),a=t.children("a.link").outerWidth(!0),l=t.children("a.purchase").outerWidth(!0),o=t.children("a.lyrics").outerWidth(!0),n=t.children("span.duration").outerWidth(!0),r=t.children("a.delete").outerWidth(!0),p=i-a-l-s-o-r-n-20;t.children("span.title").outerWidth(p)}),t.$playlist.removeClass("resizing"))},setLayout:function(){var e=this;if(e.$app.parent().width()<630?(e.$stage.add(e.$playlist).addClass("no-float"),e.$app.addClass("one-col"),e.$playlist.css("max-height",e.options.bottomPlaylistMaxHeight),e.resizeItemTitle()):t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement?(e.$stage.add(e.$playlist).addClass("no-float"),e.$playlist.css("max-height",e.options.bottomPlaylistMaxHeight),e.resizeItemTitle()):(e.$stage.add(e.$playlist).removeClass("no-float"),e.$app.removeClass("one-col"),"bottom"!==e.options.playlistPosition&&e.$playlist.css("max-height","")),e.$player.hasClass("video")&&e.player){var i=e.$player.width(),s=.5625*i;!e.isiOS&&!e.isAndroid&&e.player.media.setVideoSize(i,s),e.player.setPlayerSize(i,s),e.player.setControlsSize()}},getHiddenProp:function(){var e=["webkit","moz","ms","o"];if("hidden"in t)return"hidden";for(var i=0;i<e.length;i++)if(e[i]+"Hidden"in t)return e[i]+"Hidden";return null},isPageHidden:function(){var e=this.getHiddenProp();return e?t[e]:!1},pageVisChange:function(){this.isPageHidden()&&this.player&&this.player.pause()},playItem:function(t){var i=t.data.self,s=e(this).closest("li");s.hasClass("current")||(i.$playlist.hasClass("searching")&&(i.$searchBox.slideUp(400).find("input").val(""),i.$playlist.removeClass("searching").children("li").removeClass("filtered first last").slideDown(400).promise().done(function(){i.$playlist.animate({scrollTop:i.$playlist.children("li.current").position().top},400)})),i.curItem=s.data("id"),s.addClass("current played").siblings().removeClass("current"),i.checkTrackIndex(),i.createPlayer(i.playlist[i.curItem],i.options.autoplay),i.onItemChange())},nextTrack:function(){var e=this,t=e.$playlist.children("li"),i=t.index(t.filter("li.current"));return i===t.length-1?!1:void t.eq(++i).find("span.title").trigger(e.clickEventType)},prevTrack:function(){var e=this,t=e.$playlist.children("li"),i=t.index(t.filter("li.current"));return 0===i?!1:void t.eq(--i).find("span.title").trigger(e.clickEventType)},checkTrackIndex:function(){var e=this,t=e.$playlist.children("li"),i=t.index(t.filter("li.current"));0===i?(e.$prevTrack.removeClass("active"),e.$nextTrack.addClass("active")):i===t.length-1?(e.$prevTrack.addClass("active"),e.$nextTrack.removeClass("active")):(e.$prevTrack.addClass("active"),e.$nextTrack.addClass("active")),e.scrollPlaylist(i)},scrollPlaylist:function(e){var t=this,i=t.$playlist.innerHeight(),s=t.$playlist.children("li").eq(0).outerHeight(),a=parseInt(i/s,10),l=t.$playlist.scrollTop(),o=(e+1-a)*s;o!==l&&t.$playlist.animate({scrollTop:o},400,function(){t.$playlist.hasClass("custom-scrollbar")&&t.$playlist.perfectScrollbar("update")})},repeatTrack:function(){var e=this;e.loopEnabled=!e.loopEnabled,e.loopEnabled?e.$repeat.addClass("active"):e.$repeat.removeClass("active")},shufflePlaylist:function(){var e=this;e.shuffleEnabled=!e.shuffleEnabled,e.shuffleEnabled?e.$shuffle.addClass("active"):e.$shuffle.removeClass("active")},showPlaylist:function(){var e=this;if(e.$showPlaylist.hasClass("active"))"bottom"===e.options.playlistPosition||e.$playlist.hasClass("no-float")?e.$playlist.slideUp(600):(e.$playlist.animate({width:0},400),e.$stage.animate({width:e.$app.width()},400,function(){if(e.$playlist.css({display:"none",width:""}),e.$stage.css({width:"100%",margin:"auto","float":"none"}),e.$player.hasClass("video")){var t=e.$player.width(),i=.5625*t;e.player.setPlayerSize(t,i),e.player.setControlsSize()}})),e.$showPlaylist.removeClass("active");else{if("bottom"===e.options.playlistPosition||e.$playlist.hasClass("no-float"))e.$playlist.slideDown(600),e.$stage.css({width:"",margin:"","float":""});else{var t="audio"===e.options.mediaType?.4444:.3333;e.$playlist.css({display:"block",width:0}).animate({width:e.$app.width()*t},400),e.$stage.css({margin:"","float":""}),e.$stage.animate({width:(1-t)*e.$app.width()},400,function(){if(e.$playlist.add(e.$stage).css("width",""),e.$player.hasClass("video")){var t=e.$player.width(),i=.5625*t;e.player.setPlayerSize(t,i),e.player.setControlsSize()}})}e.$showPlaylist.addClass("active")}},setupStageLock:function(){var t,s=this;s.lockset=!1,e(i).scroll(function(){t&&clearTimeout(t),t=setTimeout(function(){s.fixStage()},10)})},fixStage:function(){var t=this,s=t.$stage.outerHeight(),a=t.$app.outerHeight(),l=t.$app.offset().top,o=l-t.options.playerFixOffset,n=o+(a-s),r=e(i).height()-t.options.playerFixOffset,p=e(i).scrollTop();s>=r||a===s?(t.$stage.removeClass("fixed scroll-end").css({left:"",top:"",width:""}),t.$app.css("padding-top",""),t.lockset=!1):!t.lockset&&p>o&&n>p?(t.$app.css("padding-top",t.$stage.outerHeight(!0)),t.$stage.css({left:t.$stage.offset().left,top:t.options.playerFixOffset,width:t.$stage.width()}).addClass("fixed").removeClass("scroll-end"),t.lockset=!0):(t.lockset&&(o>=p||p>=n)||p>=n)&&(t.$stage.removeClass("fixed").css({left:"",top:"",width:""}),p>n?t.$stage.addClass("scroll-end"):t.$app.css("padding-top",""),t.lockset=!1)},handleFullscreen:function(){var e=this;e.$makeFullscreen.hasClass("active")||t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement?(t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen(),e.$makeFullscreen.removeClass("active")):(e.$app[0].requestFullscreen?e.$app[0].requestFullscreen():e.$app[0].mozRequestFullScreen?e.$app[0].mozRequestFullScreen():e.$app[0].webkitRequestFullscreen?e.$app[0].webkitRequestFullscreen():e.$app[0].msRequestFullscreen&&e.$app[0].msRequestFullscreen(),e.$makeFullscreen.addClass("active"))},handleLights:function(){var e=this;e.$lights.toggleClass("active"),e.$overlay.fadeToggle(600);var t=e.$lights.hasClass("active")?600:0;setTimeout(function(){e.$app.toggleClass("lights-off")},t)},showSearchBox:function(){var e=this;e.$searchBox.slideToggle(400),e.$playlist.toggleClass("searching"),e.$playlist.hasClass("searching")||(e.$playlist.children("li").removeClass("filtered").slideDown(400),e.$searchBox.find("input").val(""))},deleteItem:function(t){var i=this,s=e(t.target).closest("li"),a=!1;s.slideUp(400,function(){s.hasClass("current")&&(i.player.pause(),a=0===s.next("li").length?s.prev("li").find("span.title"):s.next("li").find("span.title")),s.remove(),a&&a.trigger(i.clickEventType),i.checkTrackIndex()})},filterPlaylist:function(){var t=this,i=e.trim(t.$searchBox.find("input").val().toLowerCase());if(void 0===i||""===i)t.$playlist.children("li").removeClass("filtered first last").slideDown(400);else{var s=t.$playlist.find("span.title").filter(":contains("+i+")").closest("li").addClass("filtered").slideDown(400);t.$playlist.children("li").not(s).removeClass("filtered").slideUp(400),s.removeClass("first last").first().addClass("first").end().last().addClass("last")}t.$playlist.children("li").promise().done(function(){t.$playlist.scrollTop(0),t.$playlist.hasClass("custom-scrollbar")&&t.$playlist.perfectScrollbar("update")})},bindEvents:function(){var s=this;s.$playlist.hammer().on(s.clickEventType,"span.title, span.item-thumb",{self:s},s.playItem),e(i).on("resize orientationchange",s.resizeItemTitle.bind(s)),e(i).on("resize orientationchange",s.setLayout.bind(s));var a=this.getHiddenProp();if(this.options.stopPlaybackOnPageHide&&a){var l=a.replace(/[H|h]idden/,"")+"visibilitychange";t.addEventListener(l,this.pageVisChange.bind(s))}s.$nextTrack.hammer().on(s.clickEventType,s.nextTrack.bind(s)),s.$prevTrack.hammer().on(s.clickEventType,s.prevTrack.bind(s)),s.$repeat.hammer().on(s.clickEventType,s.repeatTrack.bind(s)),s.$shuffle.hammer().on(s.clickEventType,s.shufflePlaylist.bind(s)),s.$playlist.hammer().on(s.clickEventType,"a.delete",s.deleteItem.bind(s)),s.$showPlaylist.hammer().on(s.clickEventType,s.showPlaylist.bind(s)),s.$makeFullscreen.hammer().on(s.clickEventType,s.handleFullscreen.bind(s)),e(i).on("fullscreenchange mozfullscreenchange webkitfullscreenchange MSFullscreenChange",function(){(null===t.fullscreenElement||null===t.mozFullScreenElement||null===t.webkitFullscreenElement||null===t.msFullscreenElement)&&s.$makeFullscreen.removeClass("active")}),s.$lights.hammer().on(s.clickEventType,s.handleLights.bind(s)),s.$search.hammer().on(s.clickEventType,s.showSearchBox.bind(s)),s.$searchBox.find("input").keyup(s.filterPlaylist.bind(s));

},playerAPI:function(){var e=this;return{next:function(){e.$nextTrack.trigger(e.clickEventType)},prev:function(){e.$prevTrack.trigger(e.clickEventType)},play:function(){e.player&&e.player.play()},pause:function(){e.player&&e.player.pause()},gotoItem:function(t){e.$playlist.children("li").eq(parseInt(t,10)).find("span.title").trigger(e.clickEventType)},gotoFirstItem:function(){e.$playlist.children("li").eq(0).find("span.title").trigger(e.clickEventType)},gotoLastItem:function(){e.$playlist.children("li").last().find("span.title").trigger(e.clickEventType)},getPlaylistLength:function(){return e.playlist.length},currentItemIndex:function(){return e.$playlist.children("li").index(e.$playlist.children("li.current"))},seek:function(t){e.player.setCurrentTime(parseInt(t,10))},currentTime:function(){return e.player.getCurrentTime()},getVolume:function(){return e.player.getVolume()},setVolume:function(t){var i=parseFloat(t,10);e.player.setVolume(i),e.options.volume=i}}},started:function(){var e=this.playlist[this.curItem];return"radio"===e.type&&"flash"!==this.player.media.pluginType&&-1===this.player.media.src.indexOf(e.link)?(this.player.setSrc(e.link+"?nocache="+Math.floor(1e4*Math.random())),this.player.load(),void this.player.play()):(this.isiOS&&this.$player.find("div.mejs-fullscreen-button").css("visibility","visible"),this.options.started.call(this.$app[0]),void this.$app.trigger("started"))},paused:function(){this.options.paused.call(this.$app[0]),this.$app.trigger("paused");var e=this.playlist[this.curItem];"radio"===e.type&&("flash"===this.player.media.pluginType?this.player.media.stop():this.player.setSrc(""))},timeupdate:function(){this.options.timeupdate.call(this.$app[0]),this.$app.trigger("timeupdate")},ended:function(){this.options.ended.call(this.$app[0]),this.$app.trigger("ended")},onItemChange:function(){this.options.onItemChange.call(this.$app[0]),this.$app.trigger("onItemChange")},onSetup:function(){this.options.onSetup.call(this.$app[0]),this.$app.trigger("onSetup")}};"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),e.fn.vimuse=function(t){var i=e.extend(!0,{},e.fn.vimuse.defaults,t);return this.each(function(){if(!e.data(this,"vimuse")){var t=Object.create(s);t.init(i,this),e.data(this,"vimuse",t.playerAPI())}})},e.fn.vimuse.defaults={mediaType:"both",autoplay:!1,autoplayOnPlayerLoad:!1,volume:.8,shuffle:!1,startLanguage:"",showPlaylistOnLoad:!0,playlistProgress:!0,showURLLinks:!0,newWindowURLLinks:!0,showPurchaseLinks:!0,newWindowPurchaseLinks:!0,showDownloadLinks:!0,showLyricsLinks:!0,showFileTypeIcons:!0,showDeleteButtons:!0,showItemDuration:!0,enablePlaylistSort:!0,stopPlaybackOnPageHide:!0,playlistPosition:"bottom",bottomPlaylistMaxHeight:400,showPlaylistThumbs:!1,showAudioDetails:!0,showAudioCover:!0,showAudioTrackInfo:!0,showAuxControls:!0,fixPlayerOnScroll:!0,playerFixOffset:0,playlistURL:"playlist.json",getID3Info:!0,pullRadioTrackInfo:!0,pullRadioStreamCover:!1,radioInfoPollInterval:5e3,enableCache:!0,cacheFolder:"cache",cacheFileName:"playlist-cache.json",cacheInterval:10,phpFolder:"php",scanMP3Folder:!1,mp3Folder:"",detectMobile:!1,youtubeAPIKey:"",youtubeFeed:!1,youtubeOptions:{source:"",userID:"",playlistID:"",search:"",limit:20},vimeoFeed:!1,vimeoOptions:{source:"",userID:"",albumID:"",channelID:"",limit:20},dailymotionFeed:!1,dailymotionOptions:{source:"",userID:"",playlistID:"",groupID:"",channelID:"",limit:20},started:function(){},paused:function(){},timeupdate:function(){},ended:function(){},onItemChange:function(){},onSetup:function(){}}}(jQuery,document,window);